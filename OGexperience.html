<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="reset.css"> 
    <link rel="stylesheet" href="styles.css"> 
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&family=Fredoka:wght@300..700&family=Lora:ital,wght@0,400..700;1,400..700&family=Outfit:wght@100..900&family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&family=Fredoka:wght@300..700&family=Lora:ital,wght@0,400..700;1,400..700&family=Outfit:wght@100..900&family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&family=Fredoka:wght@300..700&family=Libre+Bodoni:ital,wght@0,400..700;1,400..700&family=Lora:ital,wght@0,400..700;1,400..700&family=Outfit:wght@100..900&family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&display=swap" rel="stylesheet">
</head>
<body>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <div id='image'></div>
        <button id="homeButton">Back to Home</button>
        <!-- Hidden popup divs for each hotspot -->
        <div id="popup_Pyongyang" class="popup">
            <div id="pyTitle" class="titles">
                <img id="pyIMG2" src="images/joseph1.png" alt="">
                <div class="headings">
                    <h3>Birthplace of Joseph Song</h3>
                    <h2>Hwanghae-do, Pyongyang, North Korea<br>1922-1944</h2>
                </div>
            </div>
            <div id="pyBody" class="bodies">
                <p id="py1" class="popupParagraphs">The true date of my grandfather, Joseph's birthday is not known, 
                    some say he was born in 1922 and some say it was 1926. We would celebrate his birthday on December 26th. </p>
                <p id="py2" class="popupParagraphs">He was the oldest of 3 brothers in a family of wealthy, Christian farmers 
                    in Hwanghae-do, Pyongyang in what is now North Korea. When Joseph was 13 years old, his father died of 
                    appendicitis and he took over the responsibility of being the man of the household.
                </p>
                <p id="py3" class="popupParagraphs">Around 1944, when the communists began to advance, Joseph was at work 
                    as a teacher at the local school. Without any notice, a cousin and Josephâ€™s middle brother came to his 
                    workplace in a stolen ambulance and told Joseph that they needed to leave immediately. The brothers were 
                    quickly stowed away in the back of the ambulance and were forced to flee their hometown without the rest of the 
                    family. My grandfather was around 18 years of age at the time and had a wife and three children. 
                    He left without knowing if they were okay, or if he would ever see them again.</p>
                <img id="pyIMG1" src="images/kidsPyongyang1930.jpeg" alt="Children playing in Pyongyang area, around 1930. Source: Photo Book of Pyongyang Diocese">
            </div>
        </div>
        <div id="popup_Seoul" class="popup">
            <div id="seoulTitle" class="titles">
                <img id="seoul2IMG" src="images/youngja1.png" alt="">
                <h3>Birthplace of Young-Ja Song</h3>
                <h2>Gyeongbokgung, Seoul, South Korea<br>1940-1945</h2>
            </div>
            <div id="seoulBody" class="bodies">
                <p id="seoul1" class="popupParagraphs"> My grandmother, Young-Ja, was born February 20th, 1940 in Seoul, South Korea. 
                    As a child she recalls being comfortable and happy, living in a three-bedroom 
                    house with her father, her mother, and two older brothers. Her father was a successful 
                    businessman, managing a soy sauce company, so they had plenty to eat, and even enough to 
                    share with the community. At a time when the country was poor, she remembers her father 
                    constantly taking people in and sharing what they had.
                </p>
                <img id="seoul1IMG" src="images/seoul1940.jpg" alt="https://www.flickr.com/photos/dok1/106518783">
            </div>
        </div>
        <div id="popup_Busan" class="popup">
            <div id="busanTitle" class="titles">
                <h3>The Flight South</h3>
                <h2>Busan, South Korea<br>1945</h2>
            </div>
            <div id="busanBody" class="bodies">
                <p id="busan1" class="popupParagraphs">Once the Korean War started, almost everyone fled South towards Busan, away from the fighting,
                     including my grandmother and grandfather.
                    </p>
                <p id="busan2" class="popupParagraphs">
                     While en route, Young-Ja and her middle brother got separated from their parents. 
                     The siblings then got jobs, her as a housekeeper and him as a bell boy. 
                     They survived on burnt rice scraps, also referred to as nurungji, and other discarded food, 
                     hiding the bits of food in her clothes to eat later.
                </p>
                <img id="busan1IMG" src="images/ship.jpg" alt="">
                <img id="busan2IMG" src="images/refugee.jpg" alt="">
            </div>
        </div>
        <div id="popup_postWar" class="popup">
            <div id="postWarTitle" class="titles">
                <h3>After the War: Rebuilding and Grieving</h3>
                <h2>Seoul, South Korea<br>1954-1971</h2>
            </div>
            <div id="postWarBody" class="bodies">
                <p id="pwar1" class="popupParagraphs">One year after the war, Young-Ja returned to her home address, looking for her family. It was there that they 
                    reunited after around four years apart. Joseph was reunited with his eldest son, but never received any 
                    news on his wife and other two children.</p>
                <p id="pwar2" class="popupParagraphs">Following the Korean War, like millions of others, my grandparents had lost all semblance of normality 
                    and were forced to start almost completely over. Both Christians, they found work through their faith; 
                    Young-Ja, as a Catholic Sunday school teacher, and Joseph, as a Presbyterian minister in Seoul, South Korea. 
                    Joseph's son, Daniel, was Young-Ja's student and adored her so much that he introduced them. 
                    They got married a few years later and began their life together.</p>
                <p id="pwar3" class="popupParagraphs">Young-Ja and Joseph had three sons, ranging from oldest to youngest: John, Charles (or Charlie), and Samuel II (or Sam). </p>
                <img id="pwar1IMG" src="images/famPic2.jpeg" alt="">
                <img id="pwar2IMG" src="images/charJohn.jpeg" alt="">
                <img id="pwar3IMG" src="images/bikes1.JPEG" alt="">
            </div>
        </div>
        <div id="popup_CA" class="popup">
            <h3>Off to California!</h3>
            <p id="CA1" class="popupParagraphs">Joseph went a year earlier to California to set things up for the family. That meant that Young-Ja had to 
                fly with three boys under the age of 5! The entire plane ride they were crawling under the seats and 
                other passengers had to tell her where they were. And when they got to
                customs all three boys ran away once again and she had to call over the intercom for them.
            </p>
            <img id="CA1IMG" src="images/bikes2.JPEG" alt="">
            <img id="CA2IMG" src="images/bikes3.JPEG" alt="">
        </div>
        <div id="popup_Anaheim" class="popup">
            <h3 id="anaheimh3">Welcome to Anaheim</h3>
            <p></p>
            <img src="" alt="">
        </div>
        <button id="contButton">Continue</button>

        <div id="airplane">
            <audio id="planeAudio">
                <source src="sounds/plane-takeoffTrim.mp3" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </div>

    <script>
        var slides = ['Pyongyang', 'Seoul', 'Busan', 'postWar', 'CA', 'Anaheim', 'EXIT', 'DowntownA', 
                        'EastA'];
        var slideIndex = 0;
        var imageWidth = 1902;
        var imageHeight = 1034;
        var aspectRatio = imageWidth / imageHeight;
        var zoomed = false;
        var hotspotId = "";
        var Hx, Hy = 0; // used to zoom in on hotspots and zoom back out 
                        // when background changes to Anaheim
        // var clickedHotspots = {}; // Keep track of how many times each hotspot has been clicked
        var hotspots = [{
                id: 'Pyongyang',
                x: 175,
                y: 480,
                height: 20,
                width: 20,
                numClicks: 0
            }, { 
                id: 'Seoul',
                x: 180,
                y: 500,
                height: 20,
                width: 20,
                numClicks: 0
            }
        ];
        $(window).resize(function() {
            positionHotSpots();
        });
        var positionHotSpots = function() {
            $('.hotspot').remove();
            var wi = 0,
                hi = 0;
            var r = $('#image').width() / $('#image').height();
            if (aspectRatio <= r) {
                wi = $('#image').width();
                hi = $('#image').width() / aspectRatio;
            } else {
                wi = $('#image').height() * aspectRatio;
                hi = $('#image').height();
            }
            var offsetTop = (hi - $('#image').height()) / 2;
            var offsetLeft = (wi - $('#image').width()) / 2;
            $.each(hotspots, function(i, h) {

                var x = (wi * h.x) / imageWidth;
                var y = (hi * h.y) / imageHeight;

                var ww = (wi * (h.width)) / imageWidth;
                var hh = (hi * (h.height)) / imageHeight;

                var hotspot = $('<div>').attr('id', h.id).addClass('hotspot').css({
                    top: y - offsetTop,
                    left: x - offsetLeft,
                    height: hh,
                    width: ww
                });
                $('body').append(hotspot);
            });

                // CLICKING ON HOTSPOTS AND ZOOMING IN
                $('.hotspot').click(function() {
                hotspotId = $(this).attr('id');
                var clickedHotspot = hotspots.find(function(hotspot) {
                        return hotspot.id === hotspotId;
                });
                // if (!zoomed) {    NO ZOOMING IN FOR NOW
                //         zoomed = true;
                //         zoomToHotspot(hotspotId);
                // } else {
                //     slideIndex = slides.indexOf(hotspotId); // get & store curr slide index 
                //     console.log(slideIndex);
                //     $('.popup').hide(); //close curr popup
                //     $('#contButton').show(); // show the continue button
                //     changeHotspotColor(hotspotId);
                //     showSlide('popup_' + hotspotId);
                //     clickedHotspot.numClicks++; // increment num clicks
                // }

                slideIndex = slides.indexOf(hotspotId); // get & store curr slide index 
                    console.log(slideIndex);
                    $('.popup').hide(); //close curr popup
                    $('#contButton').show(); // show the continue button
                    changeHotspotColor(hotspotId);
                    showSlide('popup_' + hotspotId);
                    clickedHotspot.numClicks++; // increment num clicks
            });
        };

        var zoomToHotspot = function(hotspotId) {
            var hotspot = $('#' + hotspotId);
            var Hx = hotspot.position().left + hotspot.width() / 2.5;
            var Hy = hotspot.position().top + hotspot.height() / 2.5;

            $('#image').css({
                'transform-origin': Hx + 'px ' + Hy + 'px',
                'transform': 'scale(2)'
            });
            // Adjust the position of hotspots after zoom
            $('.hotspot').each(function() {
                var newX = ($(this).position().left - Hx) * 2.5 + Hx + 13;
                var newY = ($(this).position().top - Hy) * 2.5 + Hy + 20;
                var newWidth = $(this).width() * 2;
                var newHeight = $(this).height() * 2;
                $(this).css({
                        left: newX,
                        top: newY,
                        width: newWidth,
                        height: newHeight,
                        filter: 'blur(10px)'
                });
            });
        };
        positionHotSpots();

        // Fade in and out
        function showSlide(slideId) {
            //Fade in popup
            $('#' + slideId).fadeIn().css('opacity', '100');
            $('#' + slideId).addClass('visible');
            // $('#' + hotspotId).addClass('show');
        }
        function hideSlide(slideId) {
            //Fade out popup
            $('#' + slideId).fadeOut(); 
        }

        // Continue button
        $('#contButton').click(function() {
            $('.popup').hide(); //hide curr popup if there is one
            if(slides[slideIndex] == 'Seoul') {
                // next slide is Pyongyang if it hasn't been shown yet
                if((hotspots.find(hotspot => hotspot.id === 'Pyongyang').numClicks) == 0) {
                    showSlide('popup_Pyongyang'); 
                    changeHotspotColor('Pyongyang');
                } else {
                    slideIndex = 2;
                    busan();
                    showSlide('popup_Busan');  
                }
            } else if (slides[slideIndex] == 'Pyongyang') {
                // next slide is Seoul
                showSlide('popup_Seoul'); 
                changeHotspotColor('Pyongyang');
                // $('#popup_' + slides[1]).show();
            } else if (slides[slideIndex] == 'Busan'){
                busan();
                showSlide('popup_Busan');
            } else if (slides[slideIndex] == 'postWar'){
                postWar();
                showSlide('popup_postWar');
            } else if (slides[slideIndex] == 'CA'){
                animate2CA();
                showSlide('popup_CA');
            } else if (slides[slideIndex] == 'Anaheim') {
                $('#image').css('transition', 'none'); // remove transition
                changeHotspotColor(slides[slideIndex]);
                anaheim();
                showSlide('popup_' + slides[slideIndex]); 
                anaheimHotspots();
            } else if (slides[slideIndex] == 'EXIT') {
                window.location.href = "index.html";
            } else {
                anaheimHotspots();
                // go to next slide
                changeHotspotColor(slides[slideIndex]);
                showSlide('popup_' + slides[slideIndex]); 
            }
            slideIndex++; 
        });

    var postWar = function() {
        $('.hotspot').each(function() {
            $(this).css({
                    left: 130,
                    top: 300
            });
        });
    }

    var animate2CA = function() {
        document.getElementById("planeAudio").play(); //play sound

        $('.hotspot').hide();
        //move bg image
        //set transition property to animate transform changes
        $('#image').css('transition', 'transform 15s ease-in-out');
        //move viewport to the rightmost part of the background image
        var viewportWidth = $(window).width();
        $('#image').css('transform', 'translateX(' + (- (viewportWidth * .77)) + 'px) scale(2)');       

        //animate airplane
        $('#airplane').show();
        $('#airplane').css('transition', 'transform 15s ease-in-out');
        //move viewport to the rightmost part of the background image
        var viewportWidth = $(window).width();
        var viewportHeight = $(window).height();
        $('#airplane').css('transform', 'translateX(' + (viewportWidth / 1.3) + 'px) translateY(' + (viewportHeight * .07) + 'px)');      
        // show hotspot after animation is finished
            setTimeout(function() {
                console.log("IN SET TIMEOUT");
                $('.hotspot').show();
                // Move the hotspots to their Anaheim position
                $('.hotspot').each(function() {
                    $(this).css({
                        left: 1160,
                        top: 370
                    });
                });
                $('#airplane').hide();
            }, 14950); 
       
    };

    // Move the hotspots to Busan
    var busan = function() {
        $('.hotspot').each(function() {
            $(this).css({
                    left: 140,
                    top: 330
            });
        });
    }

        var changeHotspotColor = function(hotHotspot) {
            $('.hotspot').removeClass('hotspotC'); // Remve color from all hotspots
            $('.hotspot').removeClass('hotspotC2'); 

            var ogLeft = $('#' + hotHotspot).css('left');
            var ogTop = $('#' + hotHotspot).css('top');

            if(slideIndex < 5) {
                $('#' + hotHotspot).addClass('hotspotC'); // Add color to the hotspot corresponding to the current slideIndex
            } else {
                $('#' + hotHotspot).addClass('hotspotC2'); 
            }
            $('#' + hotHotspot).css({
                'top': ogTop, 
                'left': ogLeft
            })
        };

        //Moving to california changes the backgound image
        var anaheim = function() {
            // Set new background image
            var imgURL = "images/CA_Anaheim_287970_1965_24000_geo.jpg";
            // reset background scale and background align
            $('#image').css({
                "background-image": "url(" + imgURL +")",
                "background-position": "right",
                'transform': 'scale(1)' 
            });           
        };

        // change existing hostposts and create new hotspots 
        // 4 in total
        var anaheimHotspots = function(){
            // remove existing hotspots
            hotspots = [];

            var clickedHotspot = hotspots.find(function(hotspot) {
                        return hotspot.id === 'DTAnaheim';
                });

            // Define new hotspots for Anaheim scene
            hotspots.push({
                id: 'DTAnaheim',
                x: 1250,
                y: 300,
                height: 50,
                width: 50,
                numClicks: 0
            });
            hotspots.push({
                id: 'Church',
                x: 935,
                y: 495,
                height: 50,
                width: 50,
                numClicks: 0
            });
            hotspots.push({
                id: 'EastAnaheim',
                x: 940,
                y: 570,
                height: 50,
                width: 50,
                numClicks: 0
            });
            hotspots.push({
                id: 'Katella',
                x: 1755,
                y: 323,
                height: 50,
                width: 50,
                numClicks: 0
            });

            //$(".hotspot").css(background, "orange")
            // Position hotspots on bg image
            positionHotSpots();
        }




// // Start of: FROM CHAT GPT -- I DID NOT MAKE THIS
// // All it does it make the stuff wiggle with the mouse
// // Get all elements with the class 'wiggle-on-mouse-move'
// const elementsToWiggle = document.querySelectorAll('.popup');

// // Store the original position of each popup
// const originalPositions = {};
// elementsToWiggle.forEach(element => {
//   const rect = element.getBoundingClientRect();
//   originalPositions[element.id] = {
//     top: rect.top + window.scrollY,
//     left: rect.left + window.scrollX
//   };
// });

// // Function to handle mouse move event
// function handleMouseMove(event) {
//   // Calculate the percentage to translate the element
//   const translateXPercent = (event.clientX / window.innerWidth - 0.5) * 10; // Adjust the multiplier as needed
//   const translateYPercent = (event.clientY / window.innerHeight - 0.5) * 10; // Adjust the multiplier as needed

//   // Apply the translation to each element along with wiggle effect
//   elementsToWiggle.forEach(element => {
//     const originalPos = originalPositions[element.id];
//     const newLeft = originalPos.left + (translateXPercent * 2); // Adjust the multiplier as needed
//     const newTop = originalPos.top + (translateYPercent * 2); // Adjust the multiplier as needed
    
//     // Apply translation
//     element.style.left = `${newLeft}px`;
//     element.style.top = `${newTop}px`;

//     // Apply wiggle effect
//     const wiggleX = Math.sin(Date.now() / 100) * 5; // Adjust the multiplier as needed for intensity
//     const wiggleY = Math.cos(Date.now() / 100) * 5; // Adjust the multiplier as needed for intensity
//     element.style.transform = `translate(${newLeft + wiggleX}px, ${newTop + wiggleY}px)`;
//   });
// }

//   // Add event listener for mouse move on the document
//   document.addEventListener('mousemove', handleMouseMove);
// // End of: FROM CHAT GPT -- I DID NOT MAKE THIS

    </script>
</body>
</html>
